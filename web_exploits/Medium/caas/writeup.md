### **Write-Up for "Cowsay as a Service" Challenge**

#### **Challenge Overview:**
The challenge presented us with a server running an Express.js application that provides a `cowsay` service. The goal was to find a way to read a file (`falg.txt`) on the server to retrieve a flag. However, the challenge came with restrictions on directly accessing the file, so we had to leverage command injection and various methods to bypass these restrictions.

---

### **Steps Taken to Solve the Challenge:**

1. **Initial Exploration:**
   The application exposed an endpoint `/cowsay/:message` where we could pass a message, and it would be processed by the `cowsay` program. Initially, no hints were provided, but we identified that we could inject shell commands through the `:message` parameter.

2. **Command Injection:**
   Our first step was to check if we could inject commands to access server files. Using a common shell command injection technique, we attempted to list files with:
   ```
   https://caas.mars.picoctf.net/cowsay/hello; ls -la /app
   ```
   This attempted to run `ls -la /app` after the `hello` message was processed by the `cowsay` command. However, we ran into restrictions on what commands could be executed.

3. **Identifying the File Location:**
   After some exploration and investigation of different directories, we found that the `falg.txt` file was located in the `/app` directory, not `/root` as initially suspected.

4. **Accessing the File:**
   Several methods were tried to access the contents of the `falg.txt` file, including:
   - Using `cat` directly to read the file.
   - Trying hex dumps (`hexdump`, `xxd`, `od`) to bypass command restrictions.
   - Attempting to use `base64` to encode the contents of the file.
   - Listing directories to find the correct path.

   Unfortunately, direct access methods didn’t work due to restrictions in place.

5. **Exploit – Reading File with Command Substitution:**
   The breakthrough came when we realized we could read the file's contents by leveraging command substitution in the URL. Specifically, we used:
   ```
   https://caas.mars.picoctf.net/cowsay/$(cat%20/app/falg.txt)
   ```
   This method injected the contents of the `falg.txt` file into the URL using the `$(cat /app/falg.txt)` technique, effectively reading the file and allowing us to view the flag.

---

### **Key Concepts and Techniques Used:**
- **Command Injection:** By injecting commands in the URL parameter, we were able to execute shell commands on the server.
- **Command Substitution:** We leveraged command substitution to dynamically insert the output of a command (in this case, `cat /app/falg.txt`) into the URL, which allowed us to bypass file access restrictions.
- **Directory Exploration:** We used `ls`, `find`, and other file listing techniques to identify where `falg.txt` was located on the server.

---

### **Conclusion:**
The challenge demonstrated how command injection could be used to exploit an application with poor input validation. By creatively using command substitution in the URL, we were able to retrieve the contents of the `falg.txt` file, which contained the flag.

---

### **Code Files:**

- [**index.html**](./index.html)
- [**index.js**](./index.js)

